<!-- Section des recommandations -->
<div
  *ngIf="isLoggedIn"
  class="recommendations-section py-12 bg-gray-50 min-h-screen"
>
  <div class="container mx-auto px-4">
    <!-- Message de chargement -->
    <div *ngIf="loading" class="text-center py-12">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Chargement...</span>
      </div>
      <p class="mt-4 text-gray-600 text-lg">
        Chargement de vos recommandations...
      </p>
    </div>

    <!-- Message d'erreur -->
    <div
      *ngIf="error"
      class="bg-red-100 border border-red-300 text-red-700 p-4 rounded-lg text-center max-w-2xl mx-auto mb-6"
    >
      <i class="fas fa-exclamation-triangle me-2"></i>
      {{ error }}
    </div>

    <!-- Composant de pr√©f√©rences -->
    <app-preferences
      *ngIf="showPreferences"
      (preferencesSaved)="onPreferencesSaved()"
    ></app-preferences>

    <!-- Titre de la section -->
    <div
      *ngIf="!loading && !error && !showPreferences"
      class="text-center mb-8"
    >
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-3xl font-bold text-gray-800">
          Vos recommandations personnalis√©es
        </h2>
        <button
          (click)="showPreferences = true"
          class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors duration-300 flex items-center gap-2"
        >
          <i class="fas fa-cog"></i>
          Modifier les pr√©f√©rences
        </button>
      </div>
      <p class="text-gray-600">
        D√©couvrez des lieux qui correspondent √† vos go√ªts
      </p>
    </div>

    <!-- Liste des recommandations -->
    <div
      *ngIf="!loading && !error && !showPreferences"
      class="grid gap-6 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3"
    >
      <!-- Les cards restent inchang√©es -->
      <a
        *ngFor="let place of recommendations"
        [routerLink]="['/place', place.id]"
        class="block bg-white shadow-md rounded-2xl overflow-hidden hover:shadow-xl transition-shadow duration-300 relative"
      >
        <div class="relative">
          <img
            [src]="
              place.images?.length
                ? 'http://localhost:5066' + place.images[0]
                : 'https://media.istockphoto.com/id/1409329028/vector/no-picture-available-placeholder-thumbnail-icon-illustration-design.jpg?s=612x612&w=0&k=20&c=_zOuJu755g2eEUioiOUdz_mHKJQJn-tDgIAhQzyeKUQ='
            "
            alt="{{ place.name }}"
            class="w-full h-48 object-cover"
          />
          <div class="absolute top-2 right-2 z-10">
            <button
              (click)="
                $event.stopPropagation();
                $event.preventDefault();
                openAddToListModal(place.id)
              "
              class="bg-white text-green-600 hover:text-green-800 border border-green-500 rounded-full p-2 shadow hover:shadow-md transition"
            >
              <i class="fas fa-plus"></i>
            </button>
          </div>
        </div>
        <div class="p-4">
          <h2
            class="text-xl font-semibold text-gray-800 flex items-center gap-2"
          >
            <i class="fas fa-map-marker-alt text-red-500"></i> {{ place.name }}
          </h2>
          <p class="text-sm text-gray-600 mt-1 mb-3 line-clamp-3">
            {{ place.description }}
          </p>

          <div class="text-sm text-gray-500 mb-2">
            <div class="d-flex flex-wrap gap-1">
              <span
                *ngFor="let tag of place.tags"
                class="badge bg-light text-dark"
              >
                #{{ tag }}
              </span>
            </div>
          </div>

          <div class="flex justify-between items-center">
            <span class="text-xs text-gray-400">üìç {{ place.address }}</span>
          </div>
        </div>
      </a>
    </div>

    <!-- Message si pas de recommandations -->
    <div
      *ngIf="
        !loading && !error && !showPreferences && recommendations.length === 0
      "
      class="text-center mt-12"
    >
      <div
        class="bg-blue-100 border border-blue-300 text-blue-800 p-6 rounded-xl max-w-2xl mx-auto shadow-sm"
      >
        <i class="fas fa-info-circle me-2"></i>
        Nous n'avons pas encore assez d'informations pour vous faire des
        recommandations personnalis√©es.<br />
        <span class="text-sm text-gray-700"
          >Commencez √† explorer et √† noter des lieux pour recevoir des
          suggestions adapt√©es √† vos go√ªts !</span
        >
      </div>
    </div>
  </div>
</div>

<app-landing-page *ngIf="!isLoggedIn"></app-landing-page>
<app-add-to-lists />
